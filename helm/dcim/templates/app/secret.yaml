apiVersion: v1
kind: Secret
metadata:
    name: app-secret
    namespace: {{ include "dcim.namespace" . }}
    labels:
        {{- include "dcim.labels" . | nindent 8 }}
        app.kubernetes.io/component: app
type: Opaque
data:
    # Auth.js secret — generate with: npx auth secret
    AUTH_SECRET: {{ .Values.app.secrets.AUTH_SECRET | b64enc | quote }}

    # Database URL built from postgres credentials
    DATABASE_URL: {{ include "dcim.databaseUrl" . | b64enc | quote }}

    # Initial admin credentials (used only by seed job)
    ADMIN_EMAIL: {{ .Values.app.secrets.ADMIN_EMAIL | b64enc | quote }}
    ADMIN_PASSWORD: {{ .Values.app.secrets.ADMIN_PASSWORD | b64enc | quote }}

    # SMTP (optional — for scheduled report emails)
    SMTP_HOST: {{ .Values.app.secrets.SMTP_HOST | b64enc | quote }}
    SMTP_PORT: {{ .Values.app.secrets.SMTP_PORT | b64enc | quote }}
    SMTP_USER: {{ .Values.app.secrets.SMTP_USER | b64enc | quote }}
    SMTP_PASS: {{ .Values.app.secrets.SMTP_PASS | b64enc | quote }}
    SMTP_FROM: {{ .Values.app.secrets.SMTP_FROM | b64enc | quote }}

    # Internal secret for Go service communication
    INTERNAL_SECRET: {{ .Values.goService.secrets.INTERNAL_SECRET | b64enc | quote }}
